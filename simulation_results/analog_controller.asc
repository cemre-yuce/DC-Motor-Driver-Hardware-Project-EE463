Version 4
SHEET 1 3452 5632
WIRE 720 208 688 208
WIRE 688 288 688 208
WIRE 1168 384 1168 352
WIRE 1296 384 1168 384
WIRE 1600 384 1600 352
WIRE 1600 384 1360 384
WIRE 688 432 688 368
WIRE 1168 512 1168 384
WIRE 1168 512 528 512
WIRE 1200 512 1168 512
WIRE 1344 512 1280 512
WIRE 1520 512 1424 512
WIRE 1600 512 1600 384
WIRE 1600 512 1584 512
WIRE 1632 512 1600 512
WIRE 1792 512 1632 512
WIRE 1952 512 1872 512
WIRE 2080 512 2032 512
WIRE 2272 512 2080 512
WIRE 2320 512 2272 512
WIRE 1216 592 1216 560
WIRE 1264 592 1264 560
WIRE 2080 608 2080 512
WIRE 2272 704 2272 512
WIRE 1632 752 1632 512
WIRE 2080 800 2080 688
WIRE 528 896 528 512
WIRE 528 1008 528 976
WIRE 1632 1008 1632 816
WIRE 1632 1008 528 1008
WIRE 1952 1008 1632 1008
WIRE 2080 1008 2080 864
WIRE 2080 1008 1952 1008
WIRE 2272 1008 2272 784
WIRE 2272 1008 2080 1008
WIRE 528 1040 528 1008
WIRE 1952 1040 1952 1008
WIRE 1104 1680 912 1680
WIRE 1344 1680 1168 1680
WIRE 1440 1680 1344 1680
WIRE 1552 1680 1504 1680
WIRE 1712 1680 1632 1680
WIRE 1760 1680 1712 1680
WIRE 1712 1744 1712 1680
WIRE 912 1824 912 1680
WIRE 976 1824 912 1824
WIRE 1136 1824 1040 1824
WIRE 1344 1824 1344 1680
WIRE 1344 1824 1216 1824
WIRE 1488 1824 1344 1824
WIRE 1408 1856 1392 1856
WIRE 1392 1872 1392 1856
WIRE 1488 1888 1488 1824
WIRE 1488 1888 1424 1888
WIRE 1712 1888 1712 1824
WIRE 1712 1888 1488 1888
WIRE 912 1904 912 1824
WIRE 912 1904 864 1904
WIRE 1360 1904 912 1904
WIRE 1456 1920 1424 1920
WIRE 1456 1952 1456 1920
WIRE 1712 1952 1712 1888
WIRE 1392 1968 1392 1936
WIRE 1456 2064 1456 2032
WIRE 1712 2064 1712 2032
WIRE 1344 2128 1312 2128
WIRE 1312 2208 1312 2128
WIRE 1264 2224 896 2224
WIRE 1168 2272 1056 2272
WIRE 1264 2272 1168 2272
WIRE 1168 2304 1168 2272
WIRE 1312 2320 1312 2288
WIRE 1584 2320 1312 2320
WIRE 1568 2336 1504 2336
WIRE 1584 2336 1568 2336
WIRE 1728 2336 1648 2336
WIRE 1312 2352 1312 2320
WIRE 1504 2352 1504 2336
WIRE 1568 2352 1568 2336
WIRE 1584 2352 1568 2352
WIRE 1568 2368 1568 2352
WIRE 1584 2368 1568 2368
WIRE 1568 2384 1568 2368
WIRE 1584 2384 1568 2384
WIRE 1600 2400 1600 2384
WIRE 1168 2416 1168 2384
WIRE 1312 2448 1312 2432
WIRE 1504 2448 1504 2432
WIRE 2960 2496 2912 2496
WIRE 2912 2720 2912 2496
WIRE 2912 2848 2912 2800
FLAG 1216 592 PWM
IOPIN 1216 592 In
FLAG 1952 1040 0
FLAG 1600 352 VSOURCE
IOPIN 1600 352 Out
FLAG 1168 352 VDRAIN
IOPIN 1168 352 Out
FLAG 528 1040 0
FLAG 2320 512 VOUT
IOPIN 2320 512 Out
FLAG 1264 592 0
FLAG 688 432 0
FLAG 720 208 VRAMP
IOPIN 720 208 Out
FLAG 1456 2064 0
FLAG 1456 1920 ref
FLAG 1712 2064 0
FLAG 1760 1680 VOUT
IOPIN 1760 1680 In
FLAG 864 1904 CTRL
IOPIN 864 1904 Out
FLAG 1408 1856 VDD
IOPIN 1408 1856 Out
FLAG 1392 1968 0
FLAG 2960 2496 VDD
IOPIN 2960 2496 Out
FLAG 2912 2848 0
FLAG 1056 2272 VPWMRAMP
IOPIN 1056 2272 Out
FLAG 1168 2416 0
FLAG 1728 2336 PWM
IOPIN 1728 2336 Out
FLAG 1344 2128 VDD
IOPIN 1344 2128 Out
FLAG 1312 2448 0
FLAG 896 2224 CTRL
IOPIN 896 2224 Out
FLAG 1504 2448 0
FLAG 1600 2400 0
SYMBOL sw 1296 512 M270
WINDOW 0 42 65 Left 2
WINDOW 3 43 41 Left 2
SYMATTR InstName S1
SYMATTR Value MSW
SYMBOL ind 1776 528 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
WINDOW 40 -23 56 VBottom 2
SYMATTR InstName L0
SYMATTR Value {WDSargL0}
SYMATTR SpiceLine2 IC={WDSargIo}
SYMATTR SpiceLine Rser=0m
SYMBOL voltage 528 880 R0
WINDOW 0 36 44 Left 2
WINDOW 3 36 68 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VBUS
SYMATTR Value {WDSargVs}
SYMBOL diode 1360 368 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName DSW
SYMATTR Value DID
SYMBOL res 1328 528 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName Rswitch
SYMATTR Value {WDSargRswitch}
SYMBOL cap 2064 800 R0
WINDOW 39 24 84 Left 2
SYMATTR SpiceLine IC={WDSargVout}
SYMATTR InstName C0
SYMATTR Value {WDSargC0}
SYMBOL res 2064 592 R0
SYMATTR InstName Resr
SYMATTR Value {WDSargResr}
SYMBOL res 2048 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rdcr
SYMATTR Value {WDSargRdcr}
SYMBOL res 2256 688 R0
SYMATTR InstName Rload
SYMATTR Value {WDSargR0}
SYMBOL diode 1648 816 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value DFW
SYMBOL h 688 272 R0
WINDOW 123 24 124 Left 2
SYMATTR Value2 {-1.0*{WDSargRI}}
SYMATTR InstName H1
SYMATTR Value VBUS
SYMBOL diode 1520 496 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName DBODY
SYMATTR Value DIDEAL
SYMBOL voltage 1456 1936 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -177 104 Left 2
SYMATTR Value {WDSargVref}
SYMATTR InstName V1
SYMBOL res 1728 1840 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R1
SYMATTR Value {WDSargR1}
SYMBOL res 1728 2048 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rb
SYMATTR Value {WDSargRb}
SYMBOL res 1232 1808 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {WDSargR2}
SYMBOL cap 1168 1664 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value {WDSargC3}
SYMBOL cap 1040 1808 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {WDSargC1}
SYMBOL Opamps\\UniversalOpamp2 1392 1904 M0
SYMATTR InstName U1
SYMATTR Value2 Avol=100Meg GBW=1000Meg Slew=100Meg
SYMBOL res 1648 1664 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 44 VTop 2
SYMATTR InstName R3
SYMATTR Value {WDSargR3}
SYMBOL cap 1504 1664 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 45 VTop 2
SYMATTR InstName C2
SYMATTR Value {WDSargC2}
SYMBOL voltage 2912 2704 R0
WINDOW 0 -91 49 Left 2
WINDOW 3 -91 75 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VDD1
SYMATTR Value 12V
SYMBOL sw 1312 2304 M180
WINDOW 0 41 68 Left 2
WINDOW 3 37 43 Left 2
SYMATTR InstName SPWM
SYMATTR Value COMP
SYMBOL voltage 1168 2288 R0
WINDOW 0 -191 57 Left 2
WINDOW 3 24 104 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VPWMRAMP
SYMATTR Value PULSE(0 {WDSargVramp} 0 {0.99/{WDSargFs}} 1f 0 {1/{WDSargFs}})
SYMBOL res 1328 2448 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rpwm
SYMATTR Value 1K
SYMBOL Digital\\and 1616 2288 R0
SYMATTR InstName A1
SYMATTR SpiceLine Vhigh=15 Vlow=0 Trise=10n Tfall=10n
SYMBOL voltage 1504 2336 R0
WINDOW 0 -103 57 Left 2
WINDOW 3 24 104 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VCLK
SYMATTR Value PULSE(0 12 0 1f 1f {{{WDSargDswitch_lim}/100}/{WDSargFs}} {1/{WDSargFs}})
TEXT 432 3448 Left 2 !.param LSECarg={{WDSargLm}/{({WDSargNp}*{WDSargNp})}}
TEXT 432 3480 Left 2 !.MODEL MSW SW(RON=0.01m Roff=1Meg VT=0.15V)
TEXT 432 3528 Left 2 !.MODEL DID D(RON=10m Roff=100K)
TEXT 432 3504 Left 2 !.MODEL COMP SW(RON=10m Roff=100k VT=10m)
TEXT 432 3576 Left 2 !.tran 0 {WDSargTsim} {WDSargTstart} {WDSargTstep} uic
TEXT 432 3552 Left 2 !.LIB OPAMP.SUB
TEXT 432 3600 Left 2 !.Param Tr={0.95/{WDSargFs}}
TEXT 432 4248 Left 2 !.param WDSargVs=1080.000000000000000
TEXT 432 4280 Left 2 !.Param WDSargRswitch=20.0000000000000000m
TEXT 432 4312 Left 2 !.Param WDSargL0=25u
TEXT 432 4344 Left 2 !.Param WDSargRdcr=0.01
TEXT 432 4376 Left 2 !.Param WDSargC0=200u
TEXT 432 4408 Left 2 !.Param WDSargResr=32.5636057961645590m
TEXT 432 4568 Left 2 !.Param WDSargTstart=4.9500000000000002m
TEXT 432 4600 Left 2 !.Param WDSargTstep=1.0000000000000000n
TEXT 432 4632 Left 2 !.Param WDSargVramp=1.0000000000000000
TEXT 432 3624 Left 2 !.Param Ts={1/{WDSargFs}}
TEXT 432 3648 Left 2 !.Param Vlow=0.05
TEXT 432 3672 Left 2 !.Param Vhigh=1.0
TEXT 432 4664 Left 2 !.Param WDSargLm=0.0000000000000000u
TEXT 432 4696 Left 2 !.Param WDSargNp=1.0000000000000000
TEXT 432 3232 Left 2 !.IC I(L0)={WDSargIo}
TEXT 432 3264 Left 2 !.IC V(VOUT)={WDSargVout}
TEXT 432 4720 Left 2 !.Param WDSargIo=2.0000000000000000
TEXT 432 4752 Left 2 !.Param WDSargVout=3.2999999999999998
TEXT 432 4784 Left 2 !.Param WDSargDswitch=31.5974505200724460
TEXT 432 4864 Left 2 !.Param WDSargRxtp=1.0000000000000000m
TEXT 432 4896 Left 2 !.Param WDSargRxts=1.0000000000000000m
TEXT 432 3424 Left 2 !.MODEL DFW D(RON=0.01m Roff=100K Vfwd={WDSargVdiode})
TEXT 432 4928 Left 2 !.Param WDSargVdiode=0.6000000000000000
TEXT 432 5096 Left 2 !.Param WDSargR1=10k
TEXT 432 5128 Left 2 !.Param WDSargRb=10k
TEXT 432 5160 Left 2 !.Param WDSargR2=1393.588
TEXT 432 5224 Left 2 !.Param WDSargC1=10n
TEXT 432 5288 Left 2 !.Param WDSargC3=4.7n
TEXT 432 5256 Left 2 !.Param WDSargC2=10n
TEXT 432 5192 Left 2 !.Param WDSargR3=45
TEXT 432 4960 Left 2 !.Param WDSargRI=0.4800000000000000
TEXT 432 4992 Left 2 !.Param WDSargRsense=10.0000000000000000
TEXT 432 5024 Left 2 !.Param WDSargNcs=50.0000000000000000
TEXT 432 5056 Left 2 !.Param WDSargVe_ext=0.0000000000000000
TEXT 432 5328 Left 2 !.Param WDSargRz=0.0000000000000000k
TEXT 432 5360 Left 2 !.Param WDSargVz=3.2999999999999998
TEXT 432 5392 Left 2 !.Param WDSargRled=0.0000000000000000k
TEXT 432 5424 Left 2 !.Param WDSargRbias=0.0000000000000000k
TEXT 432 5456 Left 2 !.Param WDSargRpullup=2.2000000000000002k
TEXT 432 5488 Left 2 !.Param WDSargVpullup=8.0000000000000000
TEXT 432 4816 Left 2 !.Param WDSargDswitch_lim=90.0000000000000000
TEXT 432 5520 Left 2 !.Param WDSargVf=1.3899999999999999
TEXT 432 5552 Left 2 !.Param WDSargCTR=123.0000000000000000
TEXT 432 3400 Left 2 !.MODEL DLED D(RON=0.01m Roff=100K Vfwd={WDSargVf})
TEXT 1280 3616 Left 2 ;Primary Switch:\nPeak Switch Voltage\nAverage Switch Current\nRMS Switch Current\nPeak Switch Current\nConduction Losses\nSwitching Losses\n \nDiodes:\nPeak voltage stress\nAverage Current\nRMS Current\nPeak Current\nConduction Losses
TEXT 1280 4048 Left 2 ;Output Inductor:\nRipple (pk-pk)\nPeak Current\nAverage Current\nPower Dissipation\n \nOutput Capacitor:\nRMS Current\nRipple Current (pk-pk)\nPeak Voltage\nPower Dissipation
TEXT 1280 3392 Left 2 ;Specification:\nVin\nVout\nIout\nVout ripple (pk-pk)\nDuty
TEXT 1608 3392 Left 2 !.measure WDSresVin avg V(VDRAIN)\n.measure WDSresVout avg V(vout)\n.measure WDSresIo avg I(Rload)\n.measure WDSresVr_actual PP V(vout)\n.measure WDSresDswitch_avg avg V(pwm)\n.measure WDSresDswitch param (WDSresDswitch_avg /15.0)
TEXT 1608 4072 Left 2 !.measure WDSresL0Iac PP I(L0)\n.measure WDSresL0Ipk max I(L0)\n.measure WDSresL0Iavg avg I(L0)\n.measure WDSresL0pd avg (V(VOUT,N002)*I(Rdcr))\n.measure WDSresL0Irms rms I(L0)
TEXT 1608 4240 Left 2 !.measure WDSresC0Irms rms I(C0)\n.measure WDSresC0Iac PP I(C0)\n.measure WDSresC0Vpk max V(vout)\n.measure WDSresC0pd param  WDSresC0Irms*WDSresC0Irms*{WDSargResr}
TEXT 1608 3872 Left 2 !.measure WDSresDiodeVpk max V(vsource)\n.measure WDSresDiodeIavg avg I(D1)\n.measure WDSresDiodeIrms rms I(D1)\n.measure WDSresDiodeIpk max I(D1)\n.measure WDSresDiodeLoss avg (-V(VSOURCE)*I(D1))
TEXT 1608 3648 Left 2 !.measure WDSresSwitchVpk max V(VDRAIN,VSOURCE)\n.measure WDSresSwitchIavg avg I(S1)\n.measure WDSresSwitchIrms rms I(S1)\n.measure WDSresSwitchIpk max I(S1)\n.measure WDSresSwitchLoss avg (V(N001,VSOURCE)*I(Rswitch))
TEXT 432 3864 Left 2 !.Param WDSargA1=1.2285185098461360
TEXT 432 3928 Left 2 !.Param WDSargA3=-0.1000359183388560
TEXT 432 3992 Left 2 !.Param WDSargB1=1.8000173160223438
TEXT 432 3960 Left 2 !.Param WDSargB0=-1.9115445319399298
TEXT 432 3896 Left 2 !.Param WDSargA2=-0.1284825915072801
TEXT 432 4024 Left 2 !.Param WDSargB2=1.9123196648167622
TEXT 432 4056 Left 2 !.Param WDSargB3=-1.7992421831455114
TEXT 432 4088 Left 2 !.Param WDSargKpd=0.8753185455376753
TEXT 432 4120 Left 2 !.Param WDSargTd=0.5000000000000000
TEXT 432 4152 Left 2 !.Param WDSargFsamp=200.0000000000000000k
TEXT 432 3376 Left 2 !.MODEL DIDEAL D(RON=0.01m Roff=100K Vfwd=0.01)
TEXT 432 5584 Left 2 !.Param WDSargCopto=2.7999999999999998n
TEXT 432 5616 Left 2 !.Param WDSarggm=100.0000000000000000u
TEXT 1504 4528 Left 2 !.Param WDSargFs=22.0000000000000000k
TEXT 1504 4720 Left 2 !.Param WDSargVref=90
TEXT 1536 4608 Left 2 !.param WDSargTsim=15.0000000000000000m
TEXT 488 4456 Left 2 !.Param WDSargR0=13.846
LINE Normal 464 -16 -16 -16 2
LINE Normal -16 448 -16 -16 2
LINE Normal 464 -16 -16 -16 2
LINE Normal -16 448 -16 -16 2
LINE Normal 464 -16 -16 -16 2
LINE Normal -16 448 -16 -16 2
LINE Normal 464 -16 -16 -16 2
LINE Normal -16 448 -16 -16 2
